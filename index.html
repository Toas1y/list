<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Price List Pro</title>
    <link rel="manifest" href="manifest.json">
    <style>
        :root { --bg: #050505; --card: #151515; --text: #ffffff; --accent: #2563eb; --green: #22c55e; --border: #333; }
        body { background: var(--bg); color: var(--text); font-family: -apple-system, sans-serif; margin: 0; padding: 20px; display: flex; flex-direction: column; align-items: center; }
        
        header { width: 100%; max-width: 600px; display: flex; justify-content: space-between; align-items: center; margin-bottom: 25px; border-bottom: 1px solid var(--border); padding-bottom: 15px; }
        h1 { margin: 0; font-size: 1.5rem; font-weight: 800; background: linear-gradient(90deg, #fff, #888); -webkit-background-clip: text; -webkit-text-fill-color: transparent; }
        .nav-btn { text-decoration: none; font-size: 1.2rem; background: #222; width: 40px; height: 40px; display: flex; align-items: center; justify-content: center; border-radius: 10px; border: 1px solid var(--border); }

        .controls { width: 100%; max-width: 600px; display: flex; flex-direction: column; gap: 15px; }
        .row { display: flex; gap: 10px; }
        .col { flex: 1; display: flex; flex-direction: column; }
        
        label { font-size: 0.7rem; color: #888; margin-bottom: 5px; margin-left: 4px; text-transform: uppercase; font-weight: 700; }
        select { background: var(--card); color: white; border: 1px solid var(--border); padding: 12px; font-size: 15px; border-radius: 8px; width: 100%; outline: none; transition: border 0.2s; }
        select:focus { border-color: var(--accent); }
        select:disabled { opacity: 0.3; }

        .result-card { background: #1a1a1a; width: 100%; max-width: 600px; margin-top: 30px; border-radius: 16px; padding: 20px; border: 1px solid var(--border); display: none; }
        
        .card-header { display: flex; justify-content: space-between; align-items: flex-start; margin-bottom: 15px; }
        .brand-badge { background: var(--accent); color: white; padding: 4px 8px; border-radius: 4px; font-size: 0.7rem; font-weight: bold; text-transform: uppercase; }
        .product-name { font-size: 1.3rem; font-weight: 700; color: white; margin: 10px 0 5px 0; }
        .specs { color: #888; font-size: 0.85rem; display: flex; gap: 10px; margin-bottom: 20px; padding-bottom: 15px; border-bottom: 1px solid #333; }
        .spec-item { background: #222; padding: 4px 8px; border-radius: 4px; }

        .price-row { display: flex; justify-content: space-between; align-items: flex-end; }
        .price-block small { display: block; font-size: 0.7rem; color: #666; margin-bottom: 4px; }
        .sp { font-size: 2.2rem; font-weight: 800; color: var(--green); }
        .dp { font-size: 1.4rem; color: #aaa; font-family: monospace; }
        
        .profit-bar { margin-top: 15px; background: rgba(37, 99, 235, 0.1); padding: 10px; border-radius: 8px; text-align: center; color: #60a5fa; font-weight: 600; font-size: 0.9rem; }
    </style>
</head>
<body>
    <header>
        <h1>PRICE LIST PRO</h1>
        <a href="https://toas1y.github.io/size-calc/" class="nav-btn">ðŸ§®</a>
    </header>

    <div class="controls">
        <div class="row">
            <div class="col">
                <label>1. Brand</label>
                <select id="selBrand"><option value="">Loading...</option></select>
            </div>
            <div class="col">
                <label>2. Type</label>
                <select id="selType" disabled><option>--</option></select>
            </div>
        </div>
        <div class="col">
            <label>3. Product</label>
            <select id="selProduct" disabled><option>--</option></select>
        </div>
        <div class="col">
            <label>4. Series</label>
            <select id="selSeries" disabled><option>--</option></select>
        </div>
        <div class="row">
            <div class="col">
                <label>5. Size</label>
                <select id="selSize" disabled><option>--</option></select>
            </div>
            <div class="col">
                <label>6. Thickness</label>
                <select id="selThick" disabled><option>--</option></select>
            </div>
        </div>
    </div>

    <div id="resultCard" class="result-card">
        <div class="card-header"><span class="brand-badge" id="resBrand">BRAND</span></div>
        <div class="product-name" id="resName">Product Name</div>
        <div class="specs">
            <span class="spec-item" id="resSize">Size</span>
            <span class="spec-item" id="resThick">Thickness</span>
        </div>
        <div class="price-row">
            <div class="price-block"><small>COST (DP)</small><span class="dp" id="resDP">0</span></div>
            <div class="price-block" style="text-align: right;"><small>SELL (SP)</small><span class="sp" id="resSP">0</span></div>
        </div>
        <div class="profit-bar" id="resProfit">Profit: 0</div>
    </div>

    <script>
        if ('serviceWorker' in navigator) navigator.serviceWorker.register('sw.js');

        let fullData = [];
        const els = {
            brand: document.getElementById('selBrand'),
            type: document.getElementById('selType'),
            product: document.getElementById('selProduct'),
            series: document.getElementById('selSeries'),
            size: document.getElementById('selSize'),
            thick: document.getElementById('selThick')
        };
        const card = document.getElementById('resultCard');

        fetch('data/prices.json').then(r => r.json()).then(data => {
            fullData = data;
            populate(els.brand, [...new Set(data.map(i => i.brand))].sort());
        });

        function populate(el, items) {
            el.innerHTML = '<option value="">-- Select --</option>';
            items.filter(x => x).forEach(i => {
                let opt = document.createElement('option');
                opt.value = i; opt.innerText = i; el.appendChild(opt);
            });
            el.disabled = false;
        }

        function resetFrom(key) {
            const keys = ['brand', 'type', 'product', 'series', 'size', 'thick'];
            let start = keys.indexOf(key) + 1;
            for (let i = start; i < keys.length; i++) {
                els[keys[i]].innerHTML = '<option>--</option>';
                els[keys[i]].disabled = true;
            }
            card.style.display = 'none';
        }

        els.brand.addEventListener('change', () => {
            resetFrom('brand');
            if(!els.brand.value) return;
            const sub = fullData.filter(i => i.brand === els.brand.value);
            populate(els.type, [...new Set(sub.map(i => i.type))]);
        });

        els.type.addEventListener('change', () => {
            resetFrom('type');
            if(!els.type.value) return;
            const sub = fullData.filter(i => i.brand === els.brand.value && i.type === els.type.value);
            populate(els.product, [...new Set(sub.map(i => i.product))]);
        });

        els.product.addEventListener('change', () => {
            resetFrom('product');
            if(!els.product.value) return;
            const sub = fullData.filter(i => i.brand === els.brand.value && i.type === els.type.value && i.product === els.product.value);
            populate(els.series, [...new Set(sub.map(i => i.series))]);
        });

        els.series.addEventListener('change', () => {
            resetFrom('series');
            if(!els.series.value) return;
            const sub = fullData.filter(i => i.brand === els.brand.value && i.type === els.type.value && i.product === els.product.value && i.series === els.series.value);
            populate(els.size, [...new Set(sub.map(i => i.size))]);
        });

        els.size.addEventListener('change', () => {
            resetFrom('size');
            if(!els.size.value) return;
            const sub = fullData.filter(i => i.brand === els.brand.value && i.type === els.type.value && i.product === els.product.value && i.series === els.series.value && i.size === els.size.value);
            populate(els.thick, [...new Set(sub.map(i => i.thickness))]);
        });

        els.thick.addEventListener('change', () => {
            const item = fullData.find(i => 
                i.brand === els.brand.value && 
                i.type === els.type.value && 
                i.product === els.product.value && 
                i.series === els.series.value && 
                i.size === els.size.value && 
                i.thickness === els.thick.value
            );

            if (item) {
                document.getElementById('resBrand').innerText = item.brand;
                document.getElementById('resName').innerText = `${item.product} ${item.series}`;
                document.getElementById('resSize').innerText = item.size;
                document.getElementById('resThick').innerText = item.thickness;
                document.getElementById('resDP').innerText = `â‚¹${item.dp}`;
                document.getElementById('resSP').innerText = `â‚¹${item.sp}`;
                document.getElementById('resProfit').innerText = `Profit: â‚¹${item.sp - item.dp}`;
                card.style.display = 'block';
            }
        });
    </script>
</body>
</html>
